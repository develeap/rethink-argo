apiVersion: kustomize.config.k8s.io/v1beta1
configMapGenerator:
- behavior: merge
  literals:
  - |
    repository.credentials=- passwordSecret:
        key: git_token
        name: autopilot-secret
      url: https://github.com/
      usernameSecret:
        key: git_username
        name: autopilot-secret
  name: argocd-cm
- behavior: merge
  literals:
  - |
    accounts.developer: login
    accounts.developer.enabled: true
    accounts.devops: login
    accounts.devops.enabled: true
  name: argocd-cm
- behavior: merge
  literals:
  - |
    scopes: '[groups]'
    policy.default: role:none
    policy.default.csv: |
      p, role:none, applications, get, */*, deny
      p, role:none, certificates, get, *, deny
      p, role:none, clusters, get, *, deny
      p, role:none, repositories, get, *, deny
      p, role:none, projects, get, *, deny
      p, role:none, accounts, get, *, deny
      p, role:none, gpgkeys, get, *, deny
    policy.developers.csv: |-
      p, proj:development:developer, clusters, get, https://kubernetes.default.svc:6443, allow
      p, proj:development:developer, repositories, get, https://github.com/zmynxx/rethink-argo.git, allow
      p, proj:development:developer, projects, get, development, allow
      g, developer, proj:development:developer
      p, proj:production:developer, clusters, get, https://kubernetes.default.svc:6443, allow
      p, proj:production:developer, repositories, get, https://github.com/zmynxx/rethink-argo.git, allow
      p, proj:production:developer, projects, get, production, allow
      g, develeap:developers, proj:production:developer
      g, developer, proj:production:developer
    policy.devops.csv: |-
      p, role:devops, clusters, *, *, allow
      p, role:devops, repositories, *, *, allow
      p, role:devops, projects, *, *, allow
      p, role:devops, applications, *, *, allow
      p, role:devops, certificates, *, *, allow
      p, role:devops, accounts, *, *, allow
      p, role:devops, gpgkeys, *, *, allow
      g, devops, role:devops
  name: argocd-rbac-cm
kind: Kustomization
namespace: argocd
resources:
- github.com/argoproj-labs/argocd-autopilot/manifests/base?ref=v0.4.17
